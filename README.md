```
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣤⣴⣶⡆⠀⣶⣶⣦⣤⣤⣄⠀ ⢠⣾⣿⣦
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⢰⣿⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⡄⠘⢿⣿⠟
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣧⠀⢻⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⠂⢠⣠⣤⣶⣦⡀
                                    ⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣇⠈⢿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⠏⢀⣿⣿⣿⣿⣿⣿⣦⡀
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⡆⠘⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⡏⠀⣾⣿⣿⣿⣿⣿⣿⡿⠋⢀
                                    ⠀⠀⠀⣴⣿⣦⡀⠙⢿⣿⣿⣿⣿⣿⣿⡄⠸⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⡟⠀⣼⣿⣿⣿⣿⣿⣿⠟⢀⣴⣿⣧
                                    ⠀⠀⣼⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣿⣷⡀⢹⣿⣿⣿⡇⠀⣿⣿⣿⡿⠁⣰⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣧
                                    ⠀⣼⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣧⠀⢻⣿⣿⡇⠀⣿⣿⣿⠃⢰⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⠀⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣇⠀⢿⣿⡇⠀⣿⣿⠇⢠⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠃
                                    ⣼⣶⣤⣄⡈⠙⠛⠿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⡆⠈⠛⠃⠀⠛⠋⠀⣾⣿⠟⠁⣠⣾⣿⣿⣿⣿⡿⠿⠛⠉⣀⣠⣴⣶⡄
                                    ⣿⣿⣿⣿⣿⣿⣶⣤⣀⡉⠙⠻⢿⣿⣿⣦⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⢠⣾⣿⣿⠿⠛⠋⢁⣠⣴⣶⣿⣿⣿⣿⣿⣿⡀
                                    ⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣀⠉⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠋⢁⣀⣤⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⠀⣠⣶⣄
                                    ⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀ ⢻⣿⣿⡿
                                    ⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠂⠀⠈⠙⠋
                                    ⠀⠀⠘⣿⣿⣿⣿⣿⠿⠛⠋⢁⣠⣤⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋
                                    ⠀⠀⠀⠘⠟⠋⢉⣀⣤⣶⣿⣿⣿⣿⠟⠁⣠⣦⣄⡀⠀⠀⠀⠀⠀⠀⣤⣦⡈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⠟⠁⣠⣾⣿⣿⣿⣿⣿⣶⣶⣾⣧⠀⢻⣿⣿⣦⡈⠻⣿⣿⣿⣿⡿⠟⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠈⠿⢿⣿⣿⣦⡈⠻⠛⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠺⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢀⣤⣤⡈⠙⠋⠁
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⠿⠿⠿⠿⠿⠿⠇⠀ ⣿⣿⣿⡇
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀   ⠈⠙⠋

                         /██   /██   /██   /██   /██████    /██████     /██████    /██      /██   /███████
                        | ██  | ██  | ███ | ██  |_  ██_/   /██__  ██   /██__  ██  | ███    /███  | ██__  ██
                        | ██  | ██  | ████| ██    | ██    | ██  \__/  | ██  \ ██  | ████  /████  | ██  \ ██
                        | ██  | ██  | ██ ██ ██    | ██    | ██        | ████████  | ██ ██/██ ██  | ███████/
                        | ██  | ██  | ██  ████    | ██    | ██        | ██__  ██  | ██  ███| ██  | ██____/
                        | ██  | ██  | ██\  ███    | ██    | ██    ██  | ██  | ██  | ██\  █ | ██  | ██
                        |  ██████/  | ██ \  ██   /██████  |  ██████/  | ██  | ██  | ██ \/  | ██  | ██
                         \______/   |__/  \__/  |______/   \______/   |__/  |__/  |__/     |__/  |__/
```
<p align="right"><b><sub>Version: 1.0.1</sub></b></p>

<p align="center"><b>Authors</b></p>
<p align="center">
Flavia N. Braga<br>
Luís Fernando M. Franco<br>
 
# Abstract 
<p align="justify">
This repository is constituted of the input files to run a Molecular Dynamics Simulation with GROMACS for a slit pore. A mixture of water with hydrocarbons, modeled by methane, n-butane, and n-pentane, confined in a graphene slit pore is chosen to assess the influence of the external electric field in the general confinement behavior. In this work, x and y are called the parallel directions and z is the perpenticular direction, since the wall of the system is in the z axis.
 
 
## Contents
* <a href="#disclaimer">1. Disclaimer</a>
* <a href="#language">2. Language</a>
* <a href="#building-and-compilation">3. Building and Compilation</a>
* <a href="#reporting-errors">4. Reporting Errors</a>
* <a href="#input-files-preparation">5. Input files preparation</a>
* <a href="#running-the-simulations">6. Running the simulations</a>
  


## Disclaimer
<p align="justify">
The authors make no warranties about the use of this codes. The authors hold no liabilities for the use of this software. The authors do not recommend the use of this software whatsoever. The algorithm is made freely available to clarify any details discussed in the dissertation. All information contained herein regarding any specific methodology does not constitute or imply its endorsement or recommendation by the authors.
</p>

## Language
<p align="justify">
The main program, subroutines and functions contain some explanatory comments are mainly written in C language. 
</p>

## Building and Compilation
<p align="justify">

  For compilation, we have used the GNU Compiler Collection (GCC). We tested the algorithm using some GCC versions: 9.3.0 in Ubuntu 20.04 LTS and 7.5.0 in Ubuntu 18.04 LTS.
</p>

## Reporting Errors
<p align="justify">
If you spot an error in the program files and all other documentation, please submit an issue report using the <a href="https://github.com/Flavianbraga/Codes-for-dissertation/issues)">Issues</a> tab.
</p>

## Input files preparation
<p align="justify">
The system chosen as representative of the Fischer-Tropsch synthesis was the product of the reaction: hydrocarbons and water, confined in a slit pore of graphene sheets, with 5 layers in each side of the pore of 5.88 nm of width [Papavasileiou et al., 2021]. The hydrocarbons selected were methane, n-butane, and n-pentane. The composition of the mixtures studied were calculated based on the stoichiometry of the FTS reaction and assumes a 1:1 H 2 O : CH x (x = 2 or 3) ratio in the pore.

Before running the simulations with GROMACS (version 2021.2 tested) the initial files have to be prepared for the simulation. GROMACS input files can be divided in three categories: configuration (.gro), force field (.ff and .itp), and simulation setups (.mdp). T
</p>

### Configuration files 

The configuration files of the bulk fluids are obtained from Packmol. The mixtures of hydrocarbons and water were created in a box of size 46.0725 × 47.6 × 53.2 Å. The files refered to this preparation are present in <a href="https://github.com/Flavianbraga/Simulation-of-confined-hydrocarbons-and-water-/tree/main/1_bulk">1_bulk</a>. Once in possession of the .pdb files, the following command is used, selecting one hydrocarbon of interest at a time in the file bulk.inp:

  ```console
 packmol < bulk.inp
 ```
It is important to remember that in Packmol, comments are adressed as "#" in bulk.inp. If the goal is to change the number of molecules, the .inp file must be changed.
 
Next, it is necessary to convert .pdb files to .gro files using:
 
  ```console
gmx editconf -f conf_bulk.pdb -o conf_bulk.gro -box 4.60725 4.76 5.60
  ``` 
  
The configuration file of the graphene walls is  <a href="https://github.com/Flavianbraga/Simulation-of-confined-hydrocarbons-and-water-/blob/main/2_box/em.gro">em.gro</a>. The steepest descent method was used with a maximum number of iterations equal to 50000 to relax the initial multilayer graphene. The file used as a input in GROMACS was minim.mdp.


### Force field files

The general force field implementation can be found in the topol.top file for water and graphene  and the interaction between particles. The hydrocarbons are refered in topol.top as the files: methane.itp, ethane.itp and pentane.itp. It is important to highlight that the oplsaa force field mus be installed in GROMACS for the simulation to run, or the files ffnonbonded.itp and ffbonded.itp must be also present in the folder. For further information, the reader may refer to the original papers: OPLS-AA [Jorgensen et al., 1996] for graphene and hydrocarbons and TIP4/2005 [Abascal and Vega, 2005] for water.

### Bilding the confined fluids box

Initially the bulk fluids and the graphene layers are separated, in order to unite them it is necessary to use the files available at folder <a href="https://github.com/Flavianbraga/Simulation-of-confined-hydrocarbons-and-water-/tree/main/2_box">2_box</a>. A file in the C language is used to do the merge. The first step is to compile the file:

  ```console
 gcc input_conf.c -o out -lm
 ```
Next, the program must be run. The command varies accondoing to the hydrocarbon used in the mixture because they have diffent numbers of hydrogen and carbon atoms. For methane, we have:
 
  ```console
./out em.gro conf_bulk.gro confined_xy.gro 836 1680 5 1680 4
  ``` 
  
  For n-butane:
  
  ```console
  ./out em.gro conf_bulk.gro confined_xy.gro 836 420 14 1680 4 
  ``` 
  
  While for n-pentane:
  
  ```console
  ./out em.gro conf_bulk.gro confined_xy.gro 836 336 17 1680 4 
  ``` 

## Running the simulations

To run the simulations as described in the following command lines the user must have all GROMACS input files present in <a href="https://github.com/Flavianbraga/Simulation-of-confined-hydrocarbons-and-water-/tree/main/3_simulation">3_simulation</a> plus the output file from <a href="https://github.com/Flavianbraga/Simulation-of-confined-hydrocarbons-and-water-/tree/main/2_box">2_box</a> in the current diretory where the commands will be issued.
